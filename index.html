<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width,initial-scale=1,maximum-scale=1,user-scalable=no">
<title>Rollz HQ</title>
<style>
:root{--bg:#f7f8fa;--bg2:#fff;--bg3:#f0f1f4;--text:#1a1a2e;--text2:#6b7280;--accent:#4f46e5;--accent-light:#eef2ff;--green:#16a34a;--green-light:#f0fdf4;--yellow:#d97706;--yellow-light:#fffbeb;--red:#dc2626;--red-light:#fef2f2;--blue:#2563eb;--blue-light:#eff6ff;--purple:#7c3aed;--purple-light:#f5f3ff;--border:#e5e7eb;--shadow:0 1px 3px rgba(0,0,0,.06);--radius:10px}
*{margin:0;padding:0;box-sizing:border-box;-webkit-tap-highlight-color:transparent}
body{font-family:-apple-system,BlinkMacSystemFont,'Segoe UI',Roboto,sans-serif;background:var(--bg);color:var(--text);min-height:100vh;overflow-x:hidden;padding-bottom:90px}
button{font-family:inherit}

.hdr{padding:20px 20px 14px;background:var(--bg2);border-bottom:1px solid var(--border)}
.hdr h1{font-size:22px;font-weight:700;color:var(--text)}
.hdr .sub{font-size:12px;color:var(--text2);margin-top:2px}

.stats-bar{display:flex;flex-wrap:wrap;gap:8px;padding:14px 16px;background:var(--bg2);border-bottom:1px solid var(--border)}
.stat-pill{padding:6px 14px;border-radius:20px;font-size:12px;font-weight:600;white-space:nowrap;display:flex;align-items:center;gap:6px}
.stat-pill .dot{width:7px;height:7px;border-radius:50%}

.tabs{display:flex;flex-wrap:wrap;background:var(--bg2);border-bottom:1px solid var(--border);gap:0}
.tab{flex:1 1 33.33%;padding:10px 4px;text-align:center;font-size:11px;font-weight:600;cursor:pointer;border-bottom:2px solid transparent;color:var(--text2);white-space:nowrap;text-transform:uppercase;letter-spacing:.2px;transition:all .15s;overflow:hidden}
.tab.active{color:var(--accent);border-bottom-color:var(--accent)}
.tab .badge{background:var(--accent);color:#fff;font-size:9px;padding:1px 5px;border-radius:8px;margin-left:2px;vertical-align:top;display:inline-block;min-width:16px;text-align:center;line-height:14px}

.search-bar{padding:12px 16px 8px;display:flex;gap:8px}
.search-bar input{flex:1;background:var(--bg2);border:1px solid var(--border);border-radius:var(--radius);padding:10px 14px;color:var(--text);font-size:14px;outline:none;box-shadow:var(--shadow)}
.search-bar input:focus{border-color:var(--accent);box-shadow:0 0 0 3px rgba(79,70,229,.1)}

.filter-row{display:flex;gap:6px;padding:0 16px 10px;overflow-x:auto}
.filter-btn{background:var(--bg2);border:1px solid var(--border);border-radius:20px;padding:5px 12px;font-size:12px;color:var(--text2);cursor:pointer;white-space:nowrap;box-shadow:var(--shadow)}
.filter-btn.active{background:var(--accent);border-color:var(--accent);color:#fff}

.task-list{padding:8px 12px}
.task-group-header{padding:12px 8px 6px;font-size:11px;font-weight:700;color:var(--text2);text-transform:uppercase;letter-spacing:.8px}

.task{background:var(--bg2);border:1px solid var(--border);border-radius:var(--radius);padding:14px 16px;margin-bottom:8px;cursor:pointer;transition:all .15s;box-shadow:var(--shadow)}
.task:active{transform:scale(.98);box-shadow:none}
.task .top{display:flex;align-items:flex-start;gap:10px}
.task .check{width:20px;height:20px;border-radius:50%;border:2px solid var(--border);flex-shrink:0;display:flex;align-items:center;justify-content:center;margin-top:2px;cursor:pointer;font-size:12px;color:transparent;transition:all .15s}
.task .check:hover{border-color:var(--accent)}
.task .check.done{background:var(--green);border-color:var(--green);color:#fff}
.task .title{flex:1;font-size:14px;font-weight:500;line-height:1.4;color:var(--text)}
.task.done .title{text-decoration:line-through;color:var(--text2)}
.task .meta{display:flex;gap:6px;margin-top:8px;margin-left:30px;flex-wrap:wrap;align-items:center}
.task .tag{font-size:11px;padding:2px 8px;border-radius:6px;font-weight:600}
.tag-idea{background:var(--purple-light);color:var(--purple)}
.tag-todo{background:var(--blue-light);color:var(--blue)}
.tag-progress{background:var(--yellow-light);color:var(--yellow)}
.tag-done{background:var(--green-light);color:var(--green)}
.tag-blackhat{background:#1a1a2e;color:#e0e0e0}
.tag-blocked{background:var(--red-light);color:var(--red)}
.task .cat{font-size:11px;color:var(--text2);background:var(--bg3);padding:2px 8px;border-radius:6px}
.task .priority-flag{font-size:11px;font-weight:700}
.pf-urgent{color:var(--red)}
.pf-high{color:var(--yellow)}
.task .notes-preview{font-size:12px;color:var(--text2);margin-top:6px;margin-left:30px;line-height:1.4;max-height:38px;overflow:hidden}
.task .reminder-tag{font-size:11px;color:var(--accent);background:var(--accent-light);padding:2px 8px;border-radius:6px}

.fab{position:fixed;bottom:24px;right:20px;width:52px;height:52px;border-radius:50%;background:var(--accent);border:none;color:#fff;font-size:26px;cursor:pointer;box-shadow:0 4px 14px rgba(79,70,229,.35);z-index:100;display:flex;align-items:center;justify-content:center;transition:transform .15s}
.fab:active{transform:scale(.92)}

.modal-bg{display:none;position:fixed;inset:0;background:rgba(0,0,0,.3);z-index:200;align-items:flex-end;justify-content:center}
.modal-bg.show{display:flex}
.modal{background:var(--bg2);border-radius:16px 16px 0 0;width:100%;max-width:500px;max-height:90vh;overflow-y:auto;padding:20px;animation:slideUp .2s}
@keyframes slideUp{from{transform:translateY(100%)}to{transform:translateY(0)}}
.modal h2{font-size:17px;font-weight:700;margin-bottom:16px;display:flex;align-items:center;justify-content:space-between}
.modal h2 button{background:none;border:none;color:var(--text2);font-size:22px;cursor:pointer;padding:4px;line-height:1}

.field{margin-bottom:14px}
.field label{display:block;font-size:11px;color:var(--text2);margin-bottom:5px;font-weight:700;text-transform:uppercase;letter-spacing:.5px}
.field input,.field textarea,.field select{width:100%;background:var(--bg);border:1px solid var(--border);border-radius:8px;padding:11px 14px;color:var(--text);font-size:14px;outline:none;font-family:inherit}
.field textarea{height:80px;resize:none}
.field input:focus,.field textarea:focus{border-color:var(--accent);box-shadow:0 0 0 3px rgba(79,70,229,.1)}

.status-row{display:flex;gap:6px;flex-wrap:wrap}
.status-opt{padding:7px 14px;border-radius:8px;font-size:13px;font-weight:600;cursor:pointer;border:1.5px solid var(--border);background:var(--bg);color:var(--text2);transition:all .1s}
.status-opt.active{border-color:var(--accent);background:var(--accent-light);color:var(--accent)}

.priority-row{display:flex;gap:6px}
.priority-opt{flex:1;padding:9px;text-align:center;border-radius:8px;font-size:13px;cursor:pointer;border:1.5px solid var(--border);background:var(--bg);color:var(--text2);font-weight:600;transition:all .1s}
.priority-opt.active{border-color:var(--accent);background:var(--accent-light);color:var(--accent)}

.save-btn{width:100%;padding:14px;background:var(--accent);color:#fff;border:none;border-radius:10px;font-size:15px;font-weight:700;cursor:pointer;margin-top:10px;transition:opacity .1s}
.save-btn:active{opacity:.85}
.delete-btn{width:100%;padding:12px;background:none;color:var(--red);border:1px solid var(--red);border-radius:10px;font-size:14px;cursor:pointer;margin-top:8px}

.cat-pills{display:flex;gap:6px;flex-wrap:wrap}
.cat-pill{padding:6px 12px;border-radius:8px;font-size:12px;cursor:pointer;border:1px solid var(--border);background:var(--bg);color:var(--text2);font-weight:500}
.cat-pill.active{border-color:var(--accent);color:var(--accent);background:var(--accent-light)}

.empty{text-align:center;padding:60px 20px;color:var(--text2)}
.empty .icon{font-size:40px;margin-bottom:10px;opacity:.4}
</style>
</head>
<body>

<div class="hdr">
  <h1>Rollz HQ</h1>
  <div class="sub" id="syncStatus">Local storage</div>
</div>

<div style="display:flex;gap:8px;padding:10px 16px;background:var(--bg2);border-bottom:1px solid var(--border);flex-wrap:wrap">
  <a href="https://docs.google.com/spreadsheets/d/13Q3R97feqkQKa-l4zupOXB02-Lq8zUTFTYF-24dnf0M" target="_blank" style="padding:6px 14px;border-radius:20px;font-size:12px;font-weight:600;background:var(--green-light);color:var(--green);text-decoration:none;white-space:nowrap">FL Leads (9.7K)</a>
  <a href="https://whop.com/@locknationbets" target="_blank" style="padding:6px 14px;border-radius:20px;font-size:12px;font-weight:600;background:var(--blue-light);color:var(--blue);text-decoration:none;white-space:nowrap">Whop</a>
  <a href="https://locknationbets.xyz" target="_blank" style="padding:6px 14px;border-radius:20px;font-size:12px;font-weight:600;background:var(--purple-light);color:var(--purple);text-decoration:none;white-space:nowrap">LockNation Site</a>
  <a href="https://phantombuster.com/7052429431242369/phantoms" target="_blank" style="padding:6px 14px;border-radius:20px;font-size:12px;font-weight:600;background:var(--yellow-light);color:var(--yellow);text-decoration:none;white-space:nowrap">PhantomBuster</a>
  <a href="https://app.manychat.com" target="_blank" style="padding:6px 14px;border-radius:20px;font-size:12px;font-weight:600;background:var(--red-light);color:var(--red);text-decoration:none;white-space:nowrap">ManyChat</a>
  <a href="https://app.instantly.ai" target="_blank" style="padding:6px 14px;border-radius:20px;font-size:12px;font-weight:600;background:var(--accent-light);color:var(--accent);text-decoration:none;white-space:nowrap">Instantly</a>
</div>
<div class="stats-bar" id="statsBar"></div>

<div class="tabs" id="tabs">
  <div class="tab active" data-tab="all" onclick="switchTab('all')">All</div>
  <div class="tab" data-tab="idea" onclick="switchTab('idea')">Ideas</div>
  <div class="tab" data-tab="todo" onclick="switchTab('todo')">To Do</div>
  <div class="tab" data-tab="progress" onclick="switchTab('progress')">Active</div>
  <div class="tab" data-tab="blocked" onclick="switchTab('blocked')">Blocked</div>
  <div class="tab" data-tab="done" onclick="switchTab('done')">Done</div>
  <div class="tab" data-tab="blackhat" onclick="switchTab('blackhat')" style="color:var(--text2)">Black Hat</div>
  <div class="tab" data-tab="subs" onclick="switchTab('subs')" style="color:var(--text2)">ðŸ’³ Subs</div>
</div>

<div class="search-bar">
  <input type="text" id="searchInput" placeholder="Search tasks..." oninput="render()">
</div>

<div class="filter-row" id="catFilters">
  <div class="filter-btn active" onclick="currentCat=null;render()">All</div>
  <div class="filter-btn" onclick="currentCat='LockNation';render()">LockNation</div>
  <div class="filter-btn" onclick="currentCat='Lead Gen';render()">Lead Gen</div>
  <div class="filter-btn" onclick="currentCat='Quiz Apps';render()">Quiz Apps</div>
  <div class="filter-btn" onclick="currentCat='Cannabis';render()">Cannabis</div>
  <div class="filter-btn" onclick="currentCat='Real Estate';render()">Real Estate</div>
  <div class="filter-btn" onclick="currentCat='Auto Insurance';render()">Auto Insurance</div>
  <div class="filter-btn" onclick="currentCat='IG/Social';render()">IG/Social</div>
  <div class="filter-btn" onclick="currentCat='Tech/Dev';render()">Tech/Dev</div>
  <div class="filter-btn" onclick="currentCat='Outreach';render()">Outreach</div>
  <div class="filter-btn" onclick="currentCat='Black Hat';render()" style="background:#1a1a2e;color:#e0e0e0;border-color:#1a1a2e">Black Hat</div>
  <div class="filter-btn" onclick="currentCat='Other';render()">Other</div>
</div>
<div class="task-list" id="taskList"></div>
<div id="subsPanel" style="display:none;padding:12px 16px">
  <div style="font-size:13px;color:var(--text2);margin-bottom:12px;font-weight:600">ACTIVE SUBSCRIPTIONS & TOOLS</div>
  <div id="subsList"></div>
  <div style="margin-top:16px;font-size:13px;color:var(--text2);font-weight:600">MONTHLY TOTAL: <span id="subsTotalMonth" style="color:var(--text);font-size:16px"></span></div>
  <div style="font-size:11px;color:var(--text2);margin-top:4px">* = estimated / variable. Edit subscriptions in page source.</div>
</div>

<button class="fab" onclick="openModal()">+</button>

<div class="modal-bg" id="modalBg" onclick="if(event.target===this)closeModal()">
  <div class="modal">
    <h2><span id="modalTitle">New Task</span><button onclick="closeModal()">&times;</button></h2>
    
    <div class="field">
      <label>Title</label>
      <input type="text" id="fTitle" placeholder="What needs to be done?">
    </div>
    
    <div class="field">
      <label>Notes</label>
      <textarea id="fNotes" placeholder="Details, links, context..."></textarea>
    </div>
    
    <div class="field">
      <label>Status</label>
      <div class="status-row" id="statusRow">
        <div class="status-opt" data-v="idea" onclick="pickStatus(this)">Idea</div>
        <div class="status-opt active" data-v="todo" onclick="pickStatus(this)">To Do</div>
        <div class="status-opt" data-v="progress" onclick="pickStatus(this)">Active</div>
        <div class="status-opt" data-v="blocked" onclick="pickStatus(this)">Blocked</div>
        <div class="status-opt" data-v="done" onclick="pickStatus(this)">Done</div>
        <div class="status-opt" data-v="blackhat" onclick="pickStatus(this)" style="background:#1a1a2e;color:#e0e0e0;border-color:#1a1a2e">Black Hat</div>
      </div>
    </div>
    
    <div class="field">
      <label>Priority</label>
      <div class="priority-row" id="priorityRow">
        <div class="priority-opt" data-v="low" onclick="pickPriority(this)">Low</div>
        <div class="priority-opt active" data-v="med" onclick="pickPriority(this)">Med</div>
        <div class="priority-opt" data-v="high" onclick="pickPriority(this)">High</div>
        <div class="priority-opt" data-v="urgent" onclick="pickPriority(this)">Urgent</div>
      </div>
    </div>
    
    <div class="field">
      <label>Category</label>
      <div class="cat-pills" id="catPills"></div>
      <input type="text" id="fNewCat" placeholder="+ New category" style="margin-top:8px" onkeydown="if(event.key==='Enter'){addCategory(this.value);this.value=''}">
    </div>
    
    <div class="field">
      <label>Reminder</label>
      <input type="text" id="fReminder" placeholder="What to discuss next time...">
    </div>
    
    <button class="save-btn" onclick="saveTask()">Save Task</button>
    <button class="delete-btn" id="deleteBtn" style="display:none" onclick="deleteTask()">Delete Task</button>
  </div>
</div>

<script>
const STORAGE_KEY='rollz_hq_v2';
let state=loadState(),currentTab='all',currentCat=null,editingId=null;

function defaultState(){return{tasks:[],categories:['LockNation','Lead Gen','Quiz Apps','Cannabis','Real Estate','Auto Insurance','IG/Social','Tech/Dev','Outreach','Black Hat','Other'],lastSync:null}}
function loadState(){try{const r=localStorage.getItem(STORAGE_KEY);if(r)return JSON.parse(r)}catch(e){}return defaultState()}
function saveState(){state.lastSync=Date.now();localStorage.setItem(STORAGE_KEY,JSON.stringify(state));document.getElementById('syncStatus').textContent='Saved '+new Date().toLocaleTimeString()}
function genId(){return Date.now().toString(36)+Math.random().toString(36).slice(2,6)}

function render(){renderStats();renderCatFilters();renderTasks();renderTabBadges()}

function renderStats(){
  const t=state.tasks,total=t.length,done=t.filter(x=>x.status==='done').length,active=t.filter(x=>x.status==='progress').length,blocked=t.filter(x=>x.status==='blocked').length,urgent=t.filter(x=>x.priority==='urgent'&&x.status!=='done').length;
  document.getElementById('statsBar').innerHTML=`
    <div class="stat-pill"><div class="dot" style="background:var(--blue)"></div>${total} Total</div>
    <div class="stat-pill"><div class="dot" style="background:var(--yellow)"></div>${active} Active</div>
    <div class="stat-pill"><div class="dot" style="background:var(--green)"></div>${done} Done</div>
    ${blocked?`<div class="stat-pill"><div class="dot" style="background:var(--red)"></div>${blocked} Blocked</div>`:''}
    ${urgent?`<div class="stat-pill"><div class="dot" style="background:var(--red)"></div>${urgent} Urgent</div>`:''}`;
}

function renderTabBadges(){
  document.querySelectorAll('.tab').forEach(tab=>{
    const t=tab.dataset.tab;
    const count=t==='all'?state.tasks.filter(x=>x.status!=='done').length:state.tasks.filter(x=>x.status===t).length;
    const existing=tab.querySelector('.badge');
    if(existing)existing.remove();
    if(count>0&&t!=='all'){const b=document.createElement('span');b.className='badge';b.textContent=count;tab.appendChild(b)}
  });
}

function renderCatFilters(){
  document.querySelectorAll('#catFilters .filter-btn').forEach(btn=>{
    const cat=btn.textContent.replace(/\s*\(\d+\)/,'').trim();
    const isAll=cat==='All';
    const isActive=isAll?!currentCat:currentCat===cat;
    btn.classList.toggle('active',isActive);
    if(!isAll){
      const count=state.tasks.filter(t=>t.category===cat&&t.status!=='done').length;
      const base=cat.replace(/\s*\(\d+\)/,'');
      btn.textContent=count?`${base} (${count})`:base;
    }
  });
}

function renderTasks(){
  const search=document.getElementById('searchInput').value.toLowerCase();
  let tasks=state.tasks.filter(t=>{
    if(currentTab!=='all'&&t.status!==currentTab)return false;
    if(currentCat&&t.category!==currentCat)return false;
    if(search&&!t.title.toLowerCase().includes(search)&&!(t.notes||'').toLowerCase().includes(search))return false;
    return true;
  });
  const po={urgent:0,high:1,med:2,low:3};
  tasks.sort((a,b)=>{
    if(a.status==='done'&&b.status!=='done')return 1;
    if(b.status==='done'&&a.status!=='done')return -1;
    const pa=po[a.priority]??2,pb=po[b.priority]??2;
    if(pa!==pb)return pa-pb;
    return(b.updatedAt||b.createdAt)-(a.updatedAt||a.createdAt);
  });
  if(!tasks.length){document.getElementById('taskList').innerHTML=`<div class="empty"><div class="icon">--</div><div>No tasks here yet</div><div style="margin-top:6px;font-size:13px">Tap + to add one</div></div>`;return}
  const labels={idea:'Ideas',todo:'To Do',progress:'In Progress',blocked:'Blocked',done:'Done',blackhat:'Black Hat'};
  let html='';
  if(currentTab==='all'){
    const groups={};tasks.forEach(t=>{if(!groups[t.status])groups[t.status]=[];groups[t.status].push(t)});
    for(const s of['progress','todo','idea','blocked','blackhat','done']){if(!groups[s])continue;html+=`<div class="task-group-header">${labels[s]} (${groups[s].length})</div>`;groups[s].forEach(t=>html+=renderTask(t))}
  }else{tasks.forEach(t=>html+=renderTask(t))}
  document.getElementById('taskList').innerHTML=html;
}

function renderTask(t){
  const isDone=t.status==='done';
  const pf=t.priority==='urgent'?'<span class="priority-flag pf-urgent">URGENT</span>':t.priority==='high'?'<span class="priority-flag pf-high">HIGH</span>':'';
  return`<div class="task ${isDone?'done':''}" onclick="openModal('${t.id}')">
    <div class="top">
      <div class="check ${isDone?'done':''}" onclick="event.stopPropagation();toggleDone('${t.id}')">${isDone?'&#10003;':''}</div>
      <div class="title">${escHtml(t.title)}</div>
    </div>
    <div class="meta">
      <span class="tag tag-${t.status}">${t.status==='progress'?'Active':t.status==='blackhat'?'Black Hat':t.status.charAt(0).toUpperCase()+t.status.slice(1)}</span>
      ${pf}
      ${t.category?`<span class="cat">${escHtml(t.category)}</span>`:''}
      ${t.reminder?`<span class="reminder-tag">${escHtml(t.reminder).slice(0,30)}${t.reminder.length>30?'...':''}</span>`:''}
    </div>
    ${t.notes?`<div class="notes-preview">${escHtml(t.notes)}</div>`:''}
  </div>`;
}

function escHtml(s){return(s||'').replace(/&/g,'&amp;').replace(/</g,'&lt;').replace(/>/g,'&gt;')}

function switchTab(tab){currentTab=tab;document.querySelectorAll('.tab').forEach(t=>t.classList.toggle('active',t.dataset.tab===tab));render()}

function toggleDone(id){const task=state.tasks.find(t=>t.id===id);if(!task)return;task.status=task.status==='done'?'todo':'done';task.updatedAt=Date.now();saveState();render()}

function openModal(id){
  editingId=id||null;
  const modal=document.getElementById('modalBg');
  if(id){
    const task=state.tasks.find(t=>t.id===id);if(!task)return;
    document.getElementById('modalTitle').textContent='Edit Task';
    document.getElementById('fTitle').value=task.title;
    document.getElementById('fNotes').value=task.notes||'';
    document.getElementById('fReminder').value=task.reminder||'';
    document.getElementById('deleteBtn').style.display='block';
    document.querySelectorAll('#statusRow .status-opt').forEach(o=>o.classList.toggle('active',o.dataset.v===task.status));
    document.querySelectorAll('#priorityRow .priority-opt').forEach(o=>o.classList.toggle('active',o.dataset.v===task.priority));
    renderCatPills(task.category);
  }else{
    document.getElementById('modalTitle').textContent='New Task';
    document.getElementById('fTitle').value='';document.getElementById('fNotes').value='';document.getElementById('fReminder').value='';
    document.getElementById('deleteBtn').style.display='none';
    document.querySelectorAll('#statusRow .status-opt').forEach(o=>o.classList.toggle('active',o.dataset.v==='todo'));
    document.querySelectorAll('#priorityRow .priority-opt').forEach(o=>o.classList.toggle('active',o.dataset.v==='med'));
    renderCatPills(null);
  }
  modal.classList.add('show');
  if(!id)setTimeout(()=>document.getElementById('fTitle').focus(),200);
}

function closeModal(){document.getElementById('modalBg').classList.remove('show');editingId=null}
function renderCatPills(sel){document.getElementById('catPills').innerHTML=state.categories.map(c=>`<div class="cat-pill ${sel===c?'active':''}" onclick="pickCat(this)" data-v="${c}">${c}</div>`).join('')}
function pickCat(el){document.querySelectorAll('#catPills .cat-pill').forEach(p=>p.classList.remove('active'));el.classList.add('active')}
function pickStatus(el){document.querySelectorAll('#statusRow .status-opt').forEach(o=>o.classList.remove('active'));el.classList.add('active')}
function pickPriority(el){document.querySelectorAll('#priorityRow .priority-opt').forEach(o=>o.classList.remove('active'));el.classList.add('active')}
function addCategory(name){name=name.trim();if(!name||state.categories.includes(name))return;state.categories.push(name);saveState();renderCatPills(name);document.querySelectorAll('#catPills .cat-pill').forEach(p=>p.classList.toggle('active',p.dataset.v===name))}

function saveTask(){
  const title=document.getElementById('fTitle').value.trim();if(!title){alert('Title required');return}
  const status=document.querySelector('#statusRow .status-opt.active')?.dataset.v||'todo';
  const priority=document.querySelector('#priorityRow .priority-opt.active')?.dataset.v||'med';
  const category=document.querySelector('#catPills .cat-pill.active')?.dataset.v||'';
  const notes=document.getElementById('fNotes').value.trim();
  const reminder=document.getElementById('fReminder').value.trim();
  if(editingId){const task=state.tasks.find(t=>t.id===editingId);if(task){task.title=title;task.status=status;task.priority=priority;task.category=category;task.notes=notes;task.reminder=reminder;task.updatedAt=Date.now()}}
  else{state.tasks.push({id:genId(),title,status,priority,category,notes,reminder,createdAt:Date.now(),updatedAt:Date.now()})}
  saveState();closeModal();render();
}

function deleteTask(){if(!editingId)return;if(!confirm('Delete this task?'))return;state.tasks=state.tasks.filter(t=>t.id!==editingId);saveState();closeModal();render()}

function seedIfEmpty(){
  if(state.tasks.length>0)return;
  const seeds=[
    {title:'Deploy quiz apps to GitHub Pages',status:'todo',priority:'high',category:'Quiz Apps',notes:'14 quiz apps built, need hosting. Cory setting up GitHub.'},
    {title:'Wire Google Sheets backend to all quiz apps',status:'todo',priority:'high',category:'Quiz Apps',notes:'Apps Script URL needs to be deployed and configured.'},
    {title:'Cold outreach to lead buyers',status:'todo',priority:'high',category:'Outreach',notes:'250+ buyers in BUYERS-FULL.md. Templates ready in cold-outreach-plan.md'},
    {title:'Create remaining IG accounts',status:'progress',priority:'med',category:'IG/Social',notes:'TaxGuard done. Next: JusticeLink, CaseValue today. FundPath, CreditPulse, HealthBridge Sun.'},
    {title:'Apply new bios to 12 FB pages',status:'todo',priority:'med',category:'IG/Social',notes:'Bios written in fb-pages/new-bios.md, not applied yet.'},
    {title:'Sportsbook class action ad campaign',status:'idea',priority:'urgent',category:'Lead Gen',notes:'Quiz app built. Need to deploy + run $50/day FB test. Cory is the perfect spokesperson.'},
    {title:'FL leads enrichment',status:'progress',priority:'high',category:'Lead Gen',notes:'9,786 leads. Direct scraping gets ~5%. Need Snov.io or LISTGIANT.'},
    {title:'Fill cannabis brochure questionnaire',status:'blocked',priority:'high',category:'Cannabis',notes:'Cory needs to fill cannabis-brochure/questionnaire.md. 120 Qs, 30 pre-filled.',reminder:'Cory needs to answer remaining questions'},
    {title:'Get Flowhub AU (recreational) data',status:'blocked',priority:'med',category:'Cannabis',notes:'Both tabs showing Medical. May need separate login for Adult Use numbers.'},
    {title:'PhantomBuster diversify scraping targets',status:'progress',priority:'med',category:'LockNation',notes:'Google Sheet created with 10 competitors. Sheet needs to be made public.'},
    {title:'Create 2 remaining FB pages (SavePoint, FuelHack)',status:'blocked',priority:'low',category:'IG/Social',notes:'FB blocking creation. Cory needs to create from phone.'},
    {title:'Discuss webinar with Cory',status:'todo',priority:'med',category:'LockNation',reminder:'Cory wanted to talk about webinar'},
    {title:'Email nearby towns for RE deals',status:'idea',priority:'med',category:'Real Estate',reminder:'Discuss emailing towns for real estate deals'},
    {title:'Clean up Cory email inbox',status:'todo',priority:'med',category:'Other',reminder:'Cory wants email cleanup'},
    {title:'Sign up for verified PPL platforms',status:'todo',priority:'med',category:'Lead Gen',notes:'DMS, Marketcall, LeadPoint, Astoria, QuinStreet'},
    {title:'Send outreach: insurance lead buyer + follower guy',status:'todo',priority:'high',category:'Outreach',notes:'Messages saved in workspace. Expanded niches list ready.'},
    {title:'Migrate task tracker to GitHub Pages',status:'blocked',priority:'low',category:'Tech/Dev',notes:'Netlify free tier added password. GitHub Pages is better.'},
    {title:'LLC/tax prep/lawyer quiz apps',status:'done',priority:'high',category:'Quiz Apps',notes:'lawyer-case-eval.html, tax-prep.html, llc-setup.html all built.'},
    {title:'Set up Google Alerts for class actions',status:'todo',priority:'high',category:'Lead Gen',notes:'Monitor new lawsuits for instant landing page deployment'},
    {title:'Review Hijacking â€” Claim competitor GBPs via suggest edits',status:'blackhat',priority:'high',category:'Black Hat',notes:'Find competitors with unclaimed/poorly managed GBPs. Suggest edits to phone number, hours, website. Redirect their calls to your tracking number.'},
    {title:'Fake GBP network for auto insurance leads',status:'blackhat',priority:'high',category:'Black Hat',notes:'30 business names ready in gbp-setup-execution/. Tracking CSV, post templates, landing pages all built.'},
    {title:'Parasite SEO â€” pump articles to Medium/Reddit/Quora',status:'blackhat',priority:'med',category:'Black Hat',notes:'High-DA platforms rank fast. Article templates in seo-articles/. Funnel to IG and landing pages.'},
    {title:'Mass DM via SIM farm or cloud phones',status:'blackhat',priority:'med',category:'Black Hat',notes:'Playbook in locknation-sim-farm-playbook.md. Burner accounts, rotating proxies, warm-up period.'},
    {title:'Telegram group infiltration â€” scrape competitor member lists',status:'blackhat',priority:'med',category:'Black Hat',notes:'Join competitor betting Telegram groups, scrape members, mass DM with LockNation offer.'},
    {title:'Cloned landing pages â€” replicate top converting competitor funnels',status:'blackhat',priority:'low',category:'Black Hat',notes:'Playbook in locknation-cloned-pages-scraping-playbook.md'},
  ];
  seeds.forEach(s=>{state.tasks.push({...s,id:genId(),createdAt:Date.now(),updatedAt:Date.now(),reminder:s.reminder||''})});
  saveState();
}

seedIfEmpty();

// Ensure Black Hat category + ideas exist for existing users
if(!state.categories.includes('Black Hat')){state.categories.push('Black Hat');saveState()}
if(!state.tasks.some(t=>t.status==='blackhat')){
  const bh=[
    {title:'Review Hijacking â€” Claim competitor GBPs via suggest edits',status:'blackhat',priority:'high',category:'Black Hat',notes:'Find competitors with unclaimed/poorly managed GBPs. Suggest edits to phone number, hours, website. Redirect their calls to your tracking number.'},
    {title:'Fake GBP network for auto insurance leads',status:'blackhat',priority:'high',category:'Black Hat',notes:'30 business names ready in gbp-setup-execution/. Tracking CSV, post templates, landing pages all built.'},
    {title:'Parasite SEO â€” pump articles to Medium/Reddit/Quora',status:'blackhat',priority:'med',category:'Black Hat',notes:'High-DA platforms rank fast. Article templates in seo-articles/. Funnel to IG and landing pages.'},
    {title:'Mass DM via SIM farm or cloud phones',status:'blackhat',priority:'med',category:'Black Hat',notes:'Playbook in locknation-sim-farm-playbook.md. Burner accounts, rotating proxies, warm-up period.'},
    {title:'Telegram group infiltration â€” scrape competitor member lists',status:'blackhat',priority:'med',category:'Black Hat',notes:'Join competitor betting Telegram groups, scrape members, mass DM with LockNation offer.'},
    {title:'Cloned landing pages â€” replicate top converting competitor funnels',status:'blackhat',priority:'low',category:'Black Hat',notes:'Playbook in locknation-cloned-pages-scraping-playbook.md'},
  ];
  bh.forEach(s=>{state.tasks.push({...s,id:genId(),createdAt:Date.now(),updatedAt:Date.now(),reminder:''})});
  saveState();
}

// â”€â”€ Subscriptions â”€â”€
const SUBS = [
  {name:'PhantomBuster',plan:'Starter',cost:69,cycle:'mo',url:'https://phantombuster.com',status:'active',note:'5 phantom slots, 20h exec/mo, resets monthly'},
  {name:'ManyChat',plan:'Pro',cost:15,cycle:'mo',url:'https://app.manychat.com',status:'active',note:'113K+ contacts, IG automation flows'},
  {name:'Instantly',plan:'Growth',cost:30,cycle:'mo',url:'https://app.instantly.ai',status:'active',note:'5 warmed emails @globalrevolve.com'},
  {name:'Inflact',plan:'Pro',cost:57,cycle:'mo',url:'https://inflact.com',status:'active',note:'IG auto-reply, promo, 1.6K interactions/wk'},
  {name:'Smartproxy',plan:'Residential',cost:12.5,cycle:'mo',url:'https://smartproxy.com',status:'active',note:'Rotating proxies for scraping'},
  {name:'Outscraper',plan:'Pay-as-you-go',cost:10,cycle:'mo',url:'https://outscraper.com',status:'active',note:'Maps $2/1K places, Reviews $3/1K reviews. *est'},
  {name:'Flowhub',plan:'Business',cost:0,cycle:'mo',url:'https://app.flowhub.com',status:'active',note:'Cannabis POS â€” 2 stores (Med + Rec). Cost in store ops.'},
  {name:'Whop',plan:'Creator',cost:0,cycle:'mo',url:'https://whop.com/@locknationbets',status:'active',note:'LockNation storefront. Free until revenue (takes %)'},
  {name:'OpenClaw',plan:'Pro',cost:0,cycle:'mo',url:'#',status:'active',note:'AI assistant (Rollz). Usage-based.'},
  {name:'Shopify',plan:'Not yet',cost:0,cycle:'mo',url:'https://shopify.com',status:'planned',note:'For e-commerce stores. Cory\'s buddy has ranking software.'},
  {name:'Apollo.io',plan:'Free',cost:0,cycle:'mo',url:'https://apollo.io',status:'active',note:'239M people DB. CSV enrichment locked behind $59/mo Basic.'},
];

function renderSubs(){
  const panel=document.getElementById('subsPanel');
  const list=document.getElementById('subsList');
  if(currentTab!=='subs'){panel.style.display='none';return}
  panel.style.display='block';
  let html='';
  const active=SUBS.filter(s=>s.status==='active');
  const planned=SUBS.filter(s=>s.status==='planned');
  const render=arr=>arr.map(s=>`
    <div style="background:var(--bg2);border:1px solid var(--border);border-radius:var(--radius);padding:14px 16px;margin-bottom:8px;box-shadow:var(--shadow)">
      <div style="display:flex;justify-content:space-between;align-items:center">
        <div>
          <a href="${s.url}" target="_blank" style="font-size:14px;font-weight:600;color:var(--text);text-decoration:none">${s.name}</a>
          <span style="font-size:11px;padding:2px 8px;border-radius:6px;margin-left:6px;background:${s.status==='active'?'var(--green-light)':'var(--yellow-light)'};color:${s.status==='active'?'var(--green)':'var(--yellow)'};font-weight:600">${s.plan}</span>
        </div>
        <div style="font-size:15px;font-weight:700;color:${s.cost>0?'var(--text)':'var(--green)'}">${s.cost>0?'$'+s.cost+'/'+s.cycle:'Free'}</div>
      </div>
      <div style="font-size:12px;color:var(--text2);margin-top:6px">${s.note}</div>
    </div>`).join('');
  html+='<div style="font-size:11px;font-weight:700;color:var(--text2);text-transform:uppercase;letter-spacing:.8px;padding:8px 0 6px">Active ('+active.length+')</div>';
  html+=render(active);
  if(planned.length){
    html+='<div style="font-size:11px;font-weight:700;color:var(--text2);text-transform:uppercase;letter-spacing:.8px;padding:12px 0 6px">Planned</div>';
    html+=render(planned);
  }
  list.innerHTML=html;
  const total=active.reduce((s,x)=>s+x.cost,0);
  document.getElementById('subsTotalMonth').textContent='$'+total.toFixed(2)+'/mo';
}

// Patch render and switchTab
const _origRender=render;
render=function(){_origRender();renderSubs();
  document.getElementById('taskList').style.display=currentTab==='subs'?'none':'block';
  document.querySelector('.search-bar').style.display=currentTab==='subs'?'none':'flex';
  document.getElementById('catFilters').style.display=currentTab==='subs'?'none':'flex';
  document.querySelector('.fab').style.display=currentTab==='subs'?'none':'flex';
};

render();
</script>
</body>
</html>
